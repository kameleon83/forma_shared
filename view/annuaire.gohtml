<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<meta charset="utf-8">
	<title>{{ .title }}</title>
	<!-- <link href="https://fonts.googleapis.com/css?family=Coiny" rel="stylesheet"> -->
	<link rel="stylesheet" href="/index.css" media="screen" title="no title">
</head>
<body>
	<div class="container">
		<header>
			<h1>Annuaire</h1>
			<h3>Hello {{ .ip_name }}</h3>
			<ul>
				<li><a href="/">Download File(s)</a></li>
				<li><a href="/upload">Upload File(s)</a></li>
				<li><a href="/annuaire/false/lastname">Annuaire</a></li>
			</ul>
		</header>
		<section>
			<table>
				<thead>
					<tr>
						<th class="th" data-number="0">
							<a href="/annuaire/false/lastname" class="not_reverse_annuaire arrow"><img src="/images/down-arrow.png"></a>
							Nom
							<a href="/annuaire/true/lastname" class="reverse_annuaire arrow"><img src="/images/up-arrow.png"></a>
						</th>
						<th class="th" data-number="1">
							<a href="/annuaire/false/firstname" class="not_reverse_annuaire arrow"><img src="/images/down-arrow.png"></a>
							Prénom
							<a href="/annuaire/true/firstname" class="reverse_annuaire arrow"><img src="/images/up-arrow.png"></a>
						</th>
						<th class="th" data-number="2">Fonction</th>
						<th class="th" data-number="3">Téléphone</th>
						<th class="th" data-number="4">Mail</th>
					</tr>
				</thead>
				<tbody>
					{{ range $k, $v := .users }}
					<tr {{ if $v.Prof }}class="m2i"{{ end }}>
						<td>{{ $v.Lastname }}</td>
						<td>{{ $v.Firstname }}</td>
						<td>{{ $v.Function }}</td>
						<td>{{ $v.Phone }}</td>
						<td>{{ if and (ne $v.MailPro "") (ne $v.MailPers "") }}
							<a href="mailto:{{ $v.MailPro }}">{{ $v.MailPro }} (pro)</a>
							<br>
							<a href="mailto:{{ $v.MailPers}}">{{ $v.MailPers}} (perso)</a>
							{{ else }}
							<a href="mailto:{{ $v.MailPro}}{{ $v.MailPers }}" target="_blank">{{ $v.MailPro}}{{ $v.MailPers }}</a>
							{{ end }}
						</td>
					</tr>
					{{ end }}
				</tbody>
			</table>
		</section>
	</div>
	<script src="/jquery.js" charset="utf-8"></script>
	<script>
	$(function(){
		let formateur = $('tbody tr.m2i').length
		let total = $('tbody tr').length
		let eleve = total - formateur
		let tab_tr = new Array(total)

		$('tbody tr').each(function(i, v){
			tab_tr.push(v)
		})

		$('a[href="/annuaire"]').append('<span class="nbr_annuaire">' + total + '</span>')
		$('section').prepend('<span>Nombres de contacts.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total : ' + total + '&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;Formateur : ' + formateur + '&nbsp;&nbsp;&nbsp;-&nbsp;&nbsp;&nbsp;Elèves : ' + eleve + '</span>')

		// $('section table thead tr th').each(function(){
		// 	$(this).prepend('<a href="#" class="before ' + $(this).attr('class') + '"><img src="/images/down-arrow.png"></a>')
		// 	$(this).append('<a href="#" class="after ' + $(this).attr('class') + '"><img src="/images/up-arrow.png"></a>')
		// })

		// console.log(tab_tr);

		$('.before, .after').on('click', function(){
			for (var v in tab_tr) {
				if (tab_tr.hasOwnProperty(v)) {
					console.log($(tab_tr[v]).children().first())
				}
			}
		})
	})
	</script>
</body>
</html>
